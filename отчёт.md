
# üìù –û—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–µ–∫—Ç—É Fraud Detection

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

```bash
pip install gdown numpy pandas matplotlib seaborn scikit-learn catboost xgboost
```

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

* `gdown` ‚Äî –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å Google Drive.
* `numpy` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –º–∞—Å—Å–∏–≤–∞–º–∏ —á–∏—Å–µ–ª.
* `pandas` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
* `matplotlib` –∏ `seaborn` ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è.
* `scikit-learn` ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.
* `catboost`, `xgboost` ‚Äî –º–æ–¥–µ–ª–∏ –±—É—Å—Ç–∏–Ω–≥–∞.

---

## üìä –≠—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### 1. üì• –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV. –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–Ω–∏ –±—ã–ª–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏ –±–∞–∑–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

### 2. ‚öñÔ∏è –ê–Ω–∞–ª–∏–∑ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤

–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –±—ã–ª–æ —Å–∏–ª—å–Ω–æ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º (–º–µ–Ω—å—à–∏–Ω—Å—Ç–≤–æ ‚Äî –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–∫–∞–∑—ã). –î–ª—è –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∏ –∏ –ø–æ–¥–±–æ—Ä –º–µ—Ç—Ä–∏–∫.

### 3. ‚ùå –†–∞–±–æ—Ç–∞ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏

–ë—ã–ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã boxplot-–≥—Ä–∞—Ñ–∏–∫–∏ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö.

### 4. üè∑Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ü—Ä–∏–º–µ–Ω–µ–Ω–æ one-hot-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (`PaymentType`, `service` –∏ –¥—Ä.).

### 5. ‚ûï –ò–Ω–∂–µ–Ω–µ—Ä–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏:

* `avg_unique_purchase`
* `DaysAfterRegistration`
* –∏ –¥—Ä—É–≥–∏–µ –∞–≥—Ä–µ–≥–∞—Ç—ã –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

–£–¥–∞–ª–µ–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏:

* `user_id`, `nm_id`, `mean_percent_of_ordered_items`, `min_number_of_ordered_items`, `max_number_of_ordered_items`

### 6. üîó –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ü–æ—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞. –£–¥–∞–ª–µ–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π –≤—ã—à–µ 0.95.

### 7. üï≥Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

–ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ ‚Äî –∑–∞–º–µ–Ω–∞ –Ω–∞ –º–µ–¥–∏–∞–Ω—É, –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ ‚Äî –Ω–∞ –º–æ–¥—É.

### 8. üß™ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–∞

–¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞—Å—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π, —Å –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º –ø–æ –ø—Ä–∏–∑–Ω–∞–∫–∞–º.

### 9. ‚úÖ –ò—Ç–æ–≥ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏

–§–∏–Ω–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç 28 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫ –æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏.

---

## ü§ñ –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

### 1. ‚úÇÔ∏è –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ `train_test_split` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `stratify`, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤. –¢–∞–∫–∂–µ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ `train`, `valid`.

### 2. üß† –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

–û–±—É—á–µ–Ω—ã —Ç—Ä–∏ –º–æ–¥–µ–ª–∏:

* CatBoostClassifier
* LogisticRegression
* XGBoostClassifier

### 3. üîÅ –ê–Ω—Å–∞–º–±–ª—å –º–æ–¥–µ–ª–µ–π

–°–æ–∑–¥–∞–Ω VotingClassifier —Å –≤–µ—Å–∞–º–∏: `CatBoost (3)`, `Logistic (1)`, `XGBoost (3)`, –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ ‚Äî –º—è–≥–∫–æ–µ (soft).

```python
ensemble = VotingClassifier(
    estimators=[
        ('catboost', cb),
        ('logreg', lr),
        ('xgboost', xgb)
    ],
    voting='soft',
    weights=[3, 1, 3]
)
ensemble.fit(X_train, y_train)
```

### 4. üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

* Accuracy: 0.93
* Precision: 0.92
* Recall: 0.89
* F1-score: 0.90

### 5. üßæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ú–æ–¥–µ–ª—å –∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ `joblib`:

```python
joblib.dump({
    "model": ensemble,
    "columns": X_train.columns.tolist()
}, "best_model.pkl")
```

---

## üåê Backend –∏ UI

### üìÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
fraud_app/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ best_model.pkl
‚îÇ   ‚îú‚îÄ‚îÄ ui.py
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ README.md
```

### üñ•Ô∏è UI (Streamlit)

–í `ui.py` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

* –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ CSV
* –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
* –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
streamlit run app/ui.py
```

### üê≥ Docker

–§–∞–π–ª `Dockerfile`:

```Dockerfile
FROM python:3.10-slim

WORKDIR /app

COPY app/ ./app/
COPY app/model/best_model.pkl ./app/model/
COPY app/requirements.txt .

RUN pip install --no-cache-dir -r app/requirements.txt

CMD ["streamlit", "run", "app/ui.py", "--server.port=8501", "--server.address=0.0.0.0"]
```

–°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞:

```bash
docker build -t fraud_app .
```

–ó–∞–ø—É—Å–∫:

```bash
docker run -p 8501:8501 fraud_app
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ UI –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
[http://localhost:8501](http://localhost:8501)

---

## üìé –ò—Ç–æ–≥–∏

‚úÖ –ú–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç–ª–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (precision, recall)
‚úÖ –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚úÖ –ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–ø–∞–∫–æ–≤–∞–Ω –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚úÖ –ì–æ—Ç–æ–≤ –∫ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–µ –∏–ª–∏ –¥–µ–º–æ

